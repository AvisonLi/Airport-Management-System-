<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= title || 'Crew Management - Airport Management System' %></title>
    <link rel="stylesheet" href="/css/airport-system.css">
</head>
<body>
    <!-- Sidebar Navigation -->
    <nav class="sidebar">
        <div class="logo">
            <h2>âœˆ AMS</h2>
            <span>AIRPORT MANAGEMENT SYSTEM</span>
        </div>
        
        <ul class="nav-menu">
            <li class="nav-item" data-section="passenger">
                <a href="/section/passengers">
                    <i class="icon">ðŸ‘¤</i>
                    <span>Passenger Services</span>
                </a>
            </li>
            <li class="nav-item" data-section="boarding">
                <a href="/section/boarding">
                    <i class="icon">ðŸšª</i>
                    <span>Boarding & Gates</span>
                </a>
            </li>
            <li class="nav-item" data-section="aircraft">
                <a href="/section/aircraft">
                    <i class="icon">ðŸ›©</i>
                    <span>Aircraft & Crew</span>
                </a>
            </li>
            <li class="nav-item" data-section="ground">
                <a href="/ground">
                    <i class="icon">ðŸš›</i>
                    <span>Ground Services</span>
                </a>
            </li>
            <li class="nav-item active" data-section="crew">
                <a href="/section/crew">
                    <i class="icon">ðŸ‘·</i>
                    <span>Crew Management</span>
                </a>
            </li>
        </ul>
    </nav>

    <!-- Main Content Area -->
    <main class="main-content">
        <!-- Top Bar -->
        <header class="top-bar">
            <div class="breadcrumb">
                <span id="current-section">Crew Management</span>
            </div>
            <div class="user-info">
                <div class="user-details">
                    <span class="user-name"><%= user?.full_name || 'Admin User' %></span>
                    <span class="user-role"><%= user?.role || 'admin' %></span>
                </div>
                <div class="avatar"><%= user?.avatar || 'ðŸ‘¨â€ðŸ’¼' %></div>
                <a href="/logout" class="logout-btn">
                    <span>ðŸšª</span>
                </a>
            </div>
        </header>

        <!-- Crew Management Section -->
        <section id="crew-section" class="content-section active">
            <h1>Crew Management</h1>
            
            <!-- Statistics -->
            <div class="stats-grid">
                <div class="stat-card">
                    <h3>Total Crew</h3>
                    <div class="value" id="totalCrewCount">0</div>
                </div>
                <div class="stat-card">
                    <h3>Available</h3>
                    <div class="value" id="availableCount">0</div>
                </div>
                <div class="stat-card">
                    <h3>On Task</h3>
                    <div class="value" id="onTaskCount">0</div>
                </div>
                <div class="stat-card">
                    <h3>Tasks Today</h3>
                    <div class="value" id="tasksToday">0</div>
                </div>
            </div>

            <!-- Crew Members -->
            <div class="service-card">
                <div class="card-header">
                    <h3>ðŸ‘¥ Crew Members</h3>
                    <div style="display: flex; gap: 10px;">
                        <button class="btn btn-primary" onclick="showAddCrewModal()">
                            âž• Add Crew Member
                        </button>
                        <button class="btn btn-secondary btn-sm" onclick="loadCrew()">
                            ðŸ”„ Refresh
                        </button>
                    </div>
                </div>
                <div class="card-content">
                    <div class="crew-grid" id="crewGrid">
                        <p style="text-align: center; padding: 40px; color: #666;">
                            Loading crew members...
                        </p>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Add Crew Modal -->
    <div id="addCrewModal" class="modal">
        <div class="modal-content">
            <h2>Add New Crew Member</h2>
            <form id="addCrewForm">
                <div class="form-group">
                    <label>Full Name *</label>
                    <input type="text" id="fullName" required>
                </div>

                <div class="form-group">
                    <label>Crew Type *</label>
                    <select id="crewType" required>
                        <option value="">Select type...</option>
                        <option value="cleaning">Cleaning Crew</option>
                        <option value="fueling">Fueling Crew</option>
                        <option value="catering">Catering Crew</option>
                        <option value="maintenance">Maintenance Crew</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>Qualification *</label>
                    <input type="text" id="qualification" required placeholder="e.g., Level 2 Certified">
                </div>

                <div class="form-group">
                    <label>Contact Number *</label>
                    <input type="tel" id="contactNumber" required placeholder="e.g., +1234567890">
                </div>

                <div class="form-group">
                    <label>Status</label>
                    <select id="status">
                        <option value="available">Available</option>
                        <option value="on_task">On Task</option>
                        <option value="off_duty">Off Duty</option>
                    </select>
                </div>

                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeAddCrewModal()">
                        Cancel
                    </button>
                    <button type="submit" class="btn btn-primary">
                        Add Crew Member
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Update Crew Modal -->
<div id="updateCrewModal" class="modal">
    <div class="modal-content">
        <h2>Update Crew Member</h2>
        <form id="updateCrewForm">
            <input type="hidden" id="updateCrewId">
            
            <div class="form-group">
                <label>Full Name</label>
                <input type="text" id="updateFullName" required>
            </div>

            <div class="form-group">
                <label>Crew Type</label>
                <select id="updateCrewType" required>
                    <option value="">Select type...</option>
                    <option value="cleaning">Cleaning Crew</option>
                    <option value="fueling">Fueling Crew</option>
                    <option value="catering">Catering Crew</option>
                    <option value="maintenance">Maintenance Crew</option>
                </select>
            </div>

            <div class="form-group">
                <label>Qualification</label>
                <input type="text" id="updateQualification" required placeholder="e.g., Level 2 Certified">
            </div>

            <div class="form-group">
                <label>Contact Number</label>
                <input type="tel" id="updateContactNumber" required>
            </div>

            <div class="form-group">
                <label>Status</label>
                <select id="updateStatus">
                    <option value="available">Available</option>
                    <option value="on_task">On Task</option>
                    <option value="off_duty">Off Duty</option>
                </select>
            </div>

            <div class="form-group">
                <label>Shift Start</label>
                <input type="time" id="updateShiftStart" value="08:00">
            </div>

            <div class="form-group">
                <label>Shift End</label>
                <input type="time" id="updateShiftEnd" value="16:00">
            </div>

            <div class="form-actions">
                <button type="button" class="btn btn-secondary" onclick="closeUpdateCrewModal()">
                    Cancel
                </button>
                <button type="submit" class="btn btn-success">
                    Update Crew Member
                </button>
            </div>
        </form>
    </div>
</div>

<!-- Assign Task Modal -->
<div id="assignTaskModal" class="modal">
    <div class="modal-content">
        <h2>Assign Task to Crew Member</h2>
        <form id="assignTaskForm">
            <input type="hidden" id="assignCrewId">
            
            <div class="form-group">
                <label>Crew Member</label>
                <input type="text" id="assignCrewName" readonly>
            </div>

            <div class="form-group">
                <label>Task Type *</label>
                <select id="taskType" required>
                    <option value="">Select task type...</option>
                    <option value="cleaning">Aircraft Cleaning</option>
                    <option value="fueling">Aircraft Fueling</option>
                    <option value="catering">Catering Service</option>
                    <option value="maintenance">Maintenance Check</option>
                    <option value="baggage">Baggage Handling</option>
                    <option value="pushback">Aircraft Pushback</option>
                </select>
            </div>

            <div class="form-group">
                <label>Flight Code *</label>
                <input type="text" id="taskFlightCode" required placeholder="e.g., HKA101">
            </div>

            <div class="form-group">
                <label>Task Description</label>
                <textarea id="taskDescription" rows="3" placeholder="Describe the task..."></textarea>
            </div>

            <div class="form-group">
                <label>Priority</label>
                <select id="taskPriority">
                    <option value="low">Low</option>
                    <option value="medium" selected>Medium</option>
                    <option value="high">High</option>
                    <option value="urgent">Urgent</option>
                </select>
            </div>

            <div class="form-group">
                <label>Estimated Duration (minutes)</label>
                <input type="number" id="taskDuration" value="30" min="5" max="240">
            </div>

            <div class="form-actions">
                <button type="button" class="btn btn-secondary" onclick="closeAssignTaskModal()">
                    Cancel
                </button>
                <button type="submit" class="btn btn-primary">
                    Assign Task
                </button>
            </div>
        </form>
    </div>
</div>

<!-- Confirmation Modal -->
<div id="confirmModal" class="modal">
    <div class="modal-content" style="max-width: 400px;">
        <h3 id="confirmTitle">Confirm Action</h3>
        <p id="confirmMessage">Are you sure you want to perform this action?</p>
        <div class="form-actions">
            <button type="button" class="btn btn-secondary" onclick="closeConfirmModal()">
                Cancel
            </button>
            <button type="button" class="btn btn-danger" id="confirmDeleteBtn" onclick="confirmDelete()">
                Delete
            </button>
        </div>
    </div>
</div>
    <script src="/js/crew.js"></script>
</body>
</html>